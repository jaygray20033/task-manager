<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Task Manager - Teams</title>
    <link rel="stylesheet" href="/css/style.css" />
  </head>
  <body>
    <div class="dashboard">
      <header class="dashboard-header">
        <div class="header-content">
          <div class="header-left">
            <h1>üë• Teams</h1>
            <p class="header-subtitle">Qu·∫£n l√Ω nh√≥m v√† ph√¢n c√¥ng c√¥ng vi·ªác</p>
          </div>
          <div class="user-info">
            <a href="/dashboard" class="btn btn-secondary">‚Üê V·ªÅ Dashboard</a>
            <button id="logoutBtn" class="btn btn-secondary">ƒêƒÉng xu·∫•t</button>
          </div>
        </div>
      </header>

      <main class="dashboard-main">
        <div class="container">
          <!-- Create Team Section -->
          <div class="task-input-section">
            <div class="section-header">
              <h2>‚ûï T·∫°o nh√≥m m·ªõi</h2>
            </div>
            <form id="createTeamForm">
              <div
                class="task-input-grid"
                style="grid-template-columns: 2fr 3fr auto"
              >
                <div class="input-wrapper">
                  <label for="teamName">T√™n nh√≥m</label>
                  <input
                    type="text"
                    id="teamName"
                    placeholder="VD: D·ª± √°n ABC..."
                    required
                  />
                </div>
                <div class="input-wrapper">
                  <label for="teamDescription">M√¥ t·∫£</label>
                  <input
                    type="text"
                    id="teamDescription"
                    placeholder="M√¥ t·∫£ ng·∫Øn v·ªÅ nh√≥m..."
                  />
                </div>
                <div class="input-wrapper">
                  <button type="submit" class="btn btn-primary btn-add">
                    <span>‚ûï</span> T·∫°o nh√≥m
                  </button>
                </div>
              </div>
            </form>
          </div>

          <!-- Join Team Section -->
          <div class="join-team-section">
            <h3>üîó Tham gia nh√≥m</h3>
            <form id="joinTeamForm">
              <div class="join-team-input">
                <input
                  type="text"
                  id="inviteCode"
                  placeholder="Nh·∫≠p m√£ m·ªùi (8 k√Ω t·ª±)..."
                  maxlength="8"
                  required
                />
                <button type="submit" class="btn btn-primary">Tham gia</button>
              </div>
            </form>
          </div>

          <!-- Teams List -->
          <div class="teams-list-section">
            <div class="section-header">
              <h2>üìã Danh s√°ch nh√≥m</h2>
            </div>
            <div id="teamsList" class="teams-grid">
              <!-- Teams will be loaded here -->
            </div>
            <div id="emptyTeamsState" class="empty-state">
              <div class="empty-icon">üë•</div>
              <p>Ch∆∞a c√≥ nh√≥m n√†o</p>
              <small>T·∫°o nh√≥m m·ªõi ho·∫∑c tham gia nh√≥m b·∫±ng m√£ m·ªùi!</small>
            </div>
          </div>
        </div>
      </main>
    </div>

    <!-- Team Detail Modal -->
    <div id="teamModal" class="modal">
      <div class="modal-content modal-large">
        <div class="modal-header">
          <h2 id="modalTeamName">Team Name</h2>
          <button class="modal-close" onclick="closeTeamModal()">
            &times;
          </button>
        </div>
        <div class="modal-body">
          <!-- Team Info -->
          <div class="team-info-section">
            <div class="team-info-item">
              <strong>M√£ m·ªùi:</strong>
              <div class="invite-code-display">
                <code id="teamInviteCode">XXXXXXXX</code>
                <button class="btn-copy" onclick="copyInviteCode()">
                  üìã Copy
                </button>
              </div>
            </div>
            <div class="team-info-item">
              <strong>M√¥ t·∫£:</strong>
              <span id="teamDescription">-</span>
            </div>
          </div>

          <div class="team-section">
            <div class="section-header-inline">
              <h3>üí¨ Chat nh√≥m</h3>
              <span class="online-indicator" id="chatStatus">
                <span class="status-dot"></span>
                <span class="status-text">ƒêang k·∫øt n·ªëi...</span>
              </span>
            </div>

            <div class="chat-container">
              <div class="chat-messages" id="chatMessages">
                Messages will be loaded here
              </div>

              <div
                class="chat-typing-indicator"
                id="typingIndicator"
                style="display: none"
              >
                <span class="typing-user"></span> ƒëang nh·∫≠p...
              </div>

              <form class="chat-input-form" id="chatForm">
                <div class="chat-input-wrapper">
                  <input
                    type="text"
                    id="chatInput"
                    placeholder="Nh·∫≠p tin nh·∫Øn..."
                    maxlength="2000"
                    autocomplete="off"
                  />
                  <button type="submit" class="btn-send-message" title="G·ª≠i">
                    <svg
                      xmlns="http://www.w3.org/2000/svg"
                      width="20"
                      height="20"
                      viewBox="0 0 24 24"
                      fill="none"
                      stroke="currentColor"
                      stroke-width="2"
                      stroke-linecap="round"
                      stroke-linejoin="round"
                    >
                      <line x1="22" y1="2" x2="11" y2="13"></line>
                      <polygon points="22 2 15 22 11 13 2 9 22 2"></polygon>
                    </svg>
                  </button>
                </div>
              </form>
            </div>
          </div>

          <!-- Members Section -->
          <div class="team-section">
            <div class="section-header-inline">
              <h3>üë• Th√†nh vi√™n (<span id="memberCount">0</span>)</h3>
              <button
                class="btn btn-secondary btn-small"
                onclick="showAddMemberForm()"
              >
                + Th√™m th√†nh vi√™n
              </button>
            </div>

            <!-- Th√™m form ƒë·ªÉ th√™m th√†nh vi√™n qua email -->
            <div
              id="addMemberForm"
              class="add-member-form"
              style="display: none"
            >
              <form id="addMemberFormElement">
                <div class="input-group">
                  <input
                    type="email"
                    id="memberEmail"
                    placeholder="Nh·∫≠p email th√†nh vi√™n..."
                    required
                  />
                  <button type="submit" class="btn btn-primary">Th√™m</button>
                  <button
                    type="button"
                    class="btn btn-secondary"
                    onclick="hideAddMemberForm()"
                  >
                    H·ªßy
                  </button>
                </div>
              </form>
            </div>

            <div id="membersList" class="members-list">
              <!-- Members will be loaded here -->
            </div>
          </div>

          <!-- Create Team Task -->
          <div class="team-section">
            <h3>‚ûï T·∫°o c√¥ng vi·ªác nh√≥m</h3>
            <form id="createTeamTaskForm">
              <div class="team-task-form">
                <div class="input-wrapper">
                  <label for="teamTaskDescription">M√¥ t·∫£ c√¥ng vi·ªác</label>
                  <input
                    type="text"
                    id="teamTaskDescription"
                    placeholder="Nh·∫≠p m√¥ t·∫£ c√¥ng vi·ªác..."
                    required
                  />
                </div>
                <div class="input-wrapper">
                  <label for="teamTaskCategory">H·∫°ng m·ª•c</label>
                  <input
                    type="text"
                    id="teamTaskCategory"
                    placeholder="VD: Thi·∫øt k·∫ø, L·∫≠p tr√¨nh..."
                  />
                </div>
              </div>

              <!-- Assignments -->
              <div class="assignments-section">
                <h4>Ph√¢n c√¥ng th√†nh vi√™n</h4>
                <div id="assignmentsList" class="assignments-list">
                  <!-- Assignment inputs will be added here -->
                </div>
                <button
                  type="button"
                  class="btn btn-secondary btn-small"
                  onclick="addAssignment()"
                >
                  + Th√™m ng∆∞·ªùi
                </button>
              </div>

              <button type="submit" class="btn btn-primary">
                T·∫°o c√¥ng vi·ªác
              </button>
            </form>
          </div>

          <!-- Team Tasks List -->
          <div class="team-section">
            <h3>üìù C√¥ng vi·ªác nh√≥m</h3>
            <div id="teamTasksList" class="team-tasks-list">
              <!-- Team tasks will be loaded here -->
            </div>
            <div id="emptyTeamTasksState" class="empty-state-small">
              <p>Ch∆∞a c√≥ c√¥ng vi·ªác n√†o</p>
            </div>
          </div>
        </div>
        <div class="modal-footer-actions">
          <button
            id="deleteTeamBtn"
            class="btn-delete-team"
            onclick="deleteTeam()"
            style="display: none"
          >
            X√≥a nh√≥m
          </button>
        </div>
      </div>
    </div>
    <script src="/socket.io/socket.io.js"></script>
    <script src="/js/teams.js"></script>
  </body>
</html>
